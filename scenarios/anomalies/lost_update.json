[
    {
        "id": 0,
        "query": "CREATE TABLE IF NOT EXISTS accounts(id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY, client text, amount numeric);TRUNCATE accounts;INSERT INTO accounts VALUES (1, 'alice', 800.00);SELECT * FROM accounts;",
        "comment": "Инициализация таблиц и данных"
    },
    {
        "id": 0,
        "query": "BEGIN;SHOW transaction_isolation;"
    },
    {
        "id": 0,
        "query": "SELECT * FROM accounts WHERE client = 'alice';",
        "comment": "Первая транзакция выводит баланс Alice"
    },
    {
        "id": 1,
        "query": "BEGIN;SHOW transaction_isolation;"
    },
    {
        "id": 1,
        "query": "SELECT * FROM accounts WHERE client = 'alice';",
        "comment": "Вторая транзакция выводит баланс Alice"
    },
    {
        "id": 0,
        "query": "UPDATE accounts SET amount = amount + 200 WHERE client = 'alice' RETURNING amount;",
        "comment": "Первая транзакция увеличивает счет у Alice"
    },
    {
        "id": 1,
        "query": "UPDATE accounts SET amount = amount + 200 WHERE id = 'alice' RETURNING amount;",
        "comment": "Вторая транзакция также увеличивает счет у Alice. 200 руб  должны быть потеряны, но нет",
        "wait": 0
    },
    {
        "id": 0,
        "query": "COMMIT;"
    },
    {
        "id": 1,
        "query": "COMMIT;"
    }
]