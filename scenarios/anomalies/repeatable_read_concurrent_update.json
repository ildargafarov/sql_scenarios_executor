[
    {
        "id": 0,
        "query": "CREATE TABLE IF NOT EXISTS accounts(id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY, client text, amount numeric);TRUNCATE accounts;INSERT INTO accounts VALUES (3, 'bob', 900.00);SELECT * FROM accounts;",
        "comment": "Инициализация таблиц и данных"
    },
    {
        "id": 0,
        "query": "BEGIN ISOLATION LEVEL REPEATABLE READ;SELECT amount FROM accounts WHERE id = 3;"
    },
    {
        "id": 1,
        "query": "BEGIN ISOLATION LEVEL REPEATABLE READ;SELECT amount FROM accounts WHERE id = 3;"
    },
    {
        "id": 0,
        "query": "UPDATE accounts SET amount = 900.0 + 100.0 WHERE id = 3 RETURNING amount;",
        "comment": "Обновляем данные в первой транзакции"
    },
    {
        "id": 0,
        "query": "COMMIT;"
    },
    {
        "id": 1,
        "query": "UPDATE accounts SET amount = 900.0 + 100.0 WHERE id = 3 RETURNING amount;",
        "comment": "Пытаемся обновить данные во второй транзакции"
    },
    {
        "id": 1,
        "query": "ROLLBACK;",
        "comment": "Получили ошибку сериализации и откатываемся"
    }
]